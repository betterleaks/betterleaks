# This file has been auto-generated. Do not edit manually.
# If you would like to contribute new rules, please use
# cmd/generate/config/main.go and follow the contributing guidelines
# at https://github.com/betterleaks/betterleaks/blob/master/CONTRIBUTING.md
#
# How the hell does secret scanning work? Read this:
#   https://lookingatcomputer.substack.com/p/regex-is-almost-all-you-need
#
# This is the default betterleaks configuration file.
# Rules and allowlists are defined within this file.
# Rules instruct betterleaks on what should be considered a secret.
# Allowlists instruct betterleaks on what is allowed, i.e. not a secret.

title = "{{.Title}}"

# minVersion indicates the minimum gitleaks config format version required.
# betterleaksMinVersion indicates the minimum betterleaks version required.
# If the running version is older, a warning will be logged.
minVersion = "v8.25.0"
betterleaksMinVersion = "v1.0.0"

{{ with .Allowlists }}{{ range $i, $allowlist := . }}{{ if or $allowlist.Regexes $allowlist.Paths $allowlist.Commits $allowlist.StopWords }}# TODO: change to [[allowlists]]{{println}}[allowlist]
{{- with .Description }}{{println}}description = "{{ . }}"{{ end }}
{{- with .MatchCondition }}{{println}}condition = "{{ .String }}"{{ end }}
{{- with .Commits -}}{{println}}commits = [
    {{ range $j, $commit := . }}"{{ $commit }}",{{ end }}
]{{ end }}
{{- with .Paths }}{{println}}paths = [{{ range $j, $path := . }}
    '''{{ $path }}''',{{ end }}
]{{ end }}
{{- if and .RegexTarget .Regexes }}{{println}}regexTarget = "{{ .RegexTarget }}"{{ end -}}
{{- with .Regexes }}{{println}}regexes = [{{ range $i, $regex := . }}
    '''{{ $regex }}''',{{ end }}
]{{ end }}
{{- with .StopWords }}{{println}}stopwords = [{{ range $j, $stopword := . }}
    "{{ $stopword }}",{{ end }}
]{{ end }}{{ end }}{{ end }}{{ end }}{{println}}

{{- range $i, $rule := .Rules }}{{println}}# ──────────────────────────────────────────────────────────────────────────────
# {{ $rule.RuleID }}
# ──────────────────────────────────────────────────────────────────────────────
[[rules]]
id = "{{$rule.RuleID}}"
description = "{{$rule.Description}}"
{{- with $rule.Regex }}
regex = '''{{ . }}'''{{ end -}}
{{- with $rule.Path }}
path = '''{{ . }}'''{{ end -}}
{{- with $rule.SecretGroup }}
secretGroup = {{ . }}{{ end -}}
{{- with $rule.Entropy }}
entropy = {{ . }}{{ end -}}
{{- with $rule.Keywords }}
{{- if gt (len .) 1}}
keywords = [{{ range $j, $keyword := . }}
    "{{ $keyword }}",{{ end }}
]{{else}}
keywords = [{{ range $j, $keyword := . }}"{{ $keyword }}"{{ end }}]{{end}}{{ end }}
{{- with $rule.Tags }}
tags = [
    {{ range $j, $tag := . }}"{{ $tag }}",{{ end }}
]{{ end }}
{{- with $rule.Allowlists }}{{ range $i, $allowlist := . }}{{ if or $allowlist.Regexes $allowlist.Paths $allowlist.Commits $allowlist.StopWords }}{{println}}[[rules.allowlists]]
{{- with .Description }}{{println}}description = "{{ . }}"{{ end }}
{{- with .MatchCondition }}{{println}}condition = "{{ .String }}"{{ end }}
{{- with .Commits -}}{{println}}commits = [
    {{ range $j, $commit := . }}"{{ $commit }}",{{ end }}
]{{ end }}
{{- with .Paths }}{{println}}paths = [
    {{ range $j, $path := . }}'''{{ $path }}''',{{ end }}
]{{ end }}
{{- if and .RegexTarget .Regexes }}{{println}}regexTarget = "{{ .RegexTarget }}"{{ end -}}
{{- with .Regexes }}{{println}}regexes = [{{ range $i, $regex := . }}
    '''{{ $regex }}''',{{ end }}
]{{ end }}
{{- with .StopWords }}{{println}}stopwords = [{{ range $j, $stopword := . }}
    "{{ $stopword }}",{{ end }}
]{{ end }}{{ end }}{{ end }}{{ end }}
{{- with $rule.Validation }}{{println}}[rules.validate]
type = "{{ .Type }}"
method = "{{ .Method }}"
url = "{{ .URL }}"
{{- with .Headers }}
headers = {{ tomlInlineTable . }}{{ end }}
{{- with .Body }}
body = '''{{ . }}'''{{ end }}
{{- with .Extract }}
extract = {{ tomlInlineTable . }}{{ end }}
{{- with .Match }}{{println}}match = [
{{- range $j, $clause := . }}
    { {{ with $clause.StatusCodes }}{{ if eq (len .) 1 }}status = {{ index . 0 }}, {{ else }}status = [{{ range $k, $code := . }}{{ if $k }}, {{ end }}{{ $code }}{{ end }}], {{ end }}{{ end }}{{ with $clause.Words }}words = [{{ range $k, $word := . }}'{{ $word }}', {{ end }}], {{ end }}{{ if $clause.WordsAll }}words_all = true, {{ end }}{{ with $clause.NegativeWords }}negative_words = [{{ range $k, $word := . }}'{{ $word }}', {{ end }}], {{ end }}{{ with $clause.JSON }}json = {{ tomlInlineTableAny . }}, {{ end }}{{ with $clause.Headers }}headers = {{ tomlInlineTable . }}, {{ end }}result = "{{ $clause.Result }}"{{ with $clause.Extract }}, extract = {{ tomlInlineTable . }}{{ end }} },
{{- end }}
]{{ end }}{{ end }}
{{ end }}
